<!DOCTYPE html>
<html>
<head>
<title>脚本执行方式 - Javascript编程语言</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="Javascript编程语言 - 一本开源的Javascript编程指南; An open-sourced Javascript Guide and Tutorial">
<meta name="keywords" content="Javascript, guide, open-sourced">
<link rel="stylesheet" type="text/css" href="/style.css" />

</head>
<body>
<div class="primary">
  <h1 id="-">脚本执行方式</h1>
<h2 id="-">执行入口</h2>
<ul>
<li>script标签</li>
<li><code>eval</code>函数</li>
<li><code>Function</code>构造函数</li>
<li><code>setTimeout</code>和<code>setInterval</code>函数</li>
<li>HTML标签内的事件绑定相关的內联函数（<code>onclick</code>等）</li>
<li>其他hacks</li>
</ul>
<h3 id="script-">script标签</h3>
<p>最基本，最常用的脚本引入方式。例如：</p>
<pre><code>&lt;script src=&quot;http://code.jquery.com/jquery-1.11.0.min.js&quot;&gt;&lt;/script&gt;</code></pre>
<p>尽管在HTML4和XHTML里面，要求开发者使用<code>type</code>属性来制定脚本的类型。但是主流浏览器都默认认为脚本类型是<code>text/javascript</code>。</p>
<p>在HTML5的规范内<a href="http://www.w3.org/html/wg/drafts/html/master/scripting-1.html#the-script-element">^1</a>，<code>script</code>标签的type属性是完全可选的。</p>
<h3 id="eval-">eval函数</h3>
<ul>
<li><code>eval</code> is evil</li>
<li><code>eval</code>有访问本地scope的权利</li>
</ul>
<pre><code>var a = 1;
eval(&quot;a=2&quot;);
a === 2; // ==&gt; true</code></pre>
<h3 id="function-">Function构造函数</h3>
<ul>
<li>function是“first-class citizen”<a href="https://developer.mozilla.org/en-US/docs/functional-javascript/First-class_citizen">^2</a>；自然有相应的构造函数</li>
<li><code>new Function(arg1, arg2, ..., fnStr)</code></li>
<li><code>Function</code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">^3</a>构造函数本质是创建一个函数对象；其创建的函数执行也并不能访问其所在创建环境的闭包，只能访问本地作用域（local scope）和全局作用域（global scope）</li>
<li><code>Function()</code>和<code>new Function()</code>效果一样</li>
</ul>
<pre><code>(function() {
  var a = 1;
  var func = new Function(&quot;a=2&quot;);
  func();
  a === 2; // ==&gt; false
}());
a === 2; // ==&gt; true</code></pre>
<h3 id="settimeout-setinterval">setTimeout和setInterval</h3>
<pre><code>setTimeout(&quot;alert(&#39;haha&#39;)&quot;, 0);</code></pre>
<p>这个和eval有异曲同工之妙，对作用域的访问也是类似的。</p>
<p>另外要说名，以上几点，除了script标签的方法之外，其他方法都在<code>strict</code>模式<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope/Strict_mode">^4</a>下不可用。</p>
<h3 id="html-">HTML內联事件回调</h3>
<pre><code>&lt;a href=&#39;#hello&#39; onclick=&quot;alert(this.href)&quot;&gt;Say hello&lt;/a&gt;</code></pre>
<p>这样如同在click事件的<code>Target Phase</code>运行了一个回调。<code>this</code>指向目标元素本身。</p>
<h3 id="-hack">其他Hack</h3>
<p>利用MessageChannel等新特性可以触发一些函数的执行<a href="https://github.com/kriskowal/asap/blob/master/asap.js">^5</a>。也许Javascript的其他的角落也有不少其他执行脚本的入口吧。</p>

</div>
<footer>
<p><strong>Programing in Javascript</strong> is a open-sourced book.</p>

<ul>
  <li><a href="https://github.com/RobinQu/Programing-In-Javascript/blob/master/README.md">Contributors</a></li>
  <li><a href="https://github.com/RobinQu/Programing-In-Javascript/issues">Issues</a></li>
  <li>Build Date: Thu Mar 27 2014 13:16:28 GMT+0800 (CST)</li>
  <li>Rev f63ebca</li>
</ul>
</footer>
</body>
</html>